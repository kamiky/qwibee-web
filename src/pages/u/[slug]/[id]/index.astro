---
import { profiles } from "@/data/profiles";

const { slug, id } = Astro.params;

// Get profile data first to check if it exists
const profile = profiles[id || ""];

// Check if profile exists and slug matches
if (!profile || profile.slug !== slug) {
  return Astro.redirect("/404");
}

// Redirect to the shorter URL at /u/[slug]
// Keep all query parameters
const queryString = Astro.url.search;
return Astro.redirect(`/u/${slug}${queryString}`);
---
